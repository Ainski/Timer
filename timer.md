# 计时器模块设计文档

## 信号说明

### 输入信号
- `clk`：时钟信号
- `write`：写使能信号
- `up`：计数方向控制（1=正计时，0=倒计时）
- `cut`：复位或中断信号（低电平有效）
- `insec`：秒设定输入
- `inmin`：分设定输入  
- `inhour`：时设定输入
- `start`：启动/停止控制

### 内部寄存器
- `buzy_n_r`：内部忙状态寄存器（低电平表示工作中）
- `sec_r`：秒计数寄存器
- `min_r`：分计数寄存器
- `hour_r`：时计数寄存器

### 输出信号
- `sec`：秒显示输出
- `min`：分显示输出
- `hour`：时显示输出
- `alarm`：报警信号
- `buzy_n`：忙状态输出（低电平表示工作中）

## 单纯正计时模式

```ts
{signal: [
	//input
    {name: 'clk', 	wave: 'p......|....|..|..........'},
    {name: "write",	wave: "0......|....|..|.........."},

    {name: "up" , 	wave: "x......|....|..|.........."},
    {name: "cut" , 	wave: "101....|....|..|.........."},//low as reset or cutin
    {name: "insec", wave: "x......|....|..|.........."},
    {name: "inmin", wave: "x......|....|..|.........."},
    {name: "inhour",wave: "x......|....|..|.........."},
    {name:"start",  wave: "0..10..|....|..|.........."},
  	// inside variables
    {name:"buzy_n_r",wave:"x.1.0..|....|..|.........."},
    {name: "sec_r", 	wave: "x.=..==|====|==|==========", "data": ["0","1","","59","0","1","","59"]},
    {name: "min_r", 	wave: "x.=....|.=..|=.|==========", "data": ["0","1","","59"]},
    {name: "hour_r",	wave: "x.=....|....|..|=.......==", "data": ["0","1"]},
  
    //output
    {name: "sec", 	wave: "x.=..==|====|==|==========", "data": ["0","1","","59","0","1","","59"]},
    {name: "min", 	wave: "x.=....|.=..|=.|==========", "data": ["0","1","","59"]},
    {name: "hour",	wave: "x.=....|....|..|=.......==", "data": ["0","1"]},
    {name:"alarm",	wave: "0......|....|..|.........."},
    {name:"buzy_n", wave: "x.1.0..|....|..|.........."}//low as working

]}
```

## 设定正计时模式

```ts
{signal: [
  // 输入信号
  {name: 'clk',     wave: 'p...|...|....'},
  {name: 'write',   wave: '0.10..|.10|....'},
  {name: 'up',      wave: '0.10..|...|....'},
  {name: 'cut',     wave: '101...|...|....'},
  {name: 'insec',   wave: '0.30..|.=0|....', data: ['10','1']},
  {name: 'inmin',   wave: '0.30..|.=0|....', data: ['5','1']},
  {name: 'inhour',  wave: '0.30..|.=0|....', data: ['1','1']},
  {name: 'start',   wave: '0.10..|.10|....'},
  
  // 内部寄存器
  {name:"buzy_n_r", wave: "x.1.0..|...|...."},
  {name: "sec_r",   wave: "x..===|===|====", data: ['0','1',"",'59']},
  {name: "min_r",   wave: "x..=..|.==|====", data: ['0','1',"","59"]},
  {name: "hour_r",  wave: "x..=..|...|.=..", data: ['0',"1"]},
  
  // 输出信号
  {name: 'sec',     wave: 'x..===|===|====', data: ['0','1',"",'59']},
  {name: 'min',     wave: 'x..=..|.==|====', data: ['0','1',"","59"]},
  {name: 'hour',    wave: 'x..=..|...|.=..', data: ['0',"1"]},
  {name: 'alarm',   wave: '0.....|...|.10.'},
  {name: 'buzy_n',  wave: 'x1.0..|...|..1.'}
]}
```

## 设定倒计时模式

```ts
{signal: [
  // 输入信号
  {name: 'clk',     wave: 'p......|...|....'},
  {name: 'write',   wave: '0.10...|.10|....'},
  {name: 'up',      wave: '0.10...|...|....'},
  {name: 'cut',     wave: '101....|...|....'},
  {name: 'insec',   wave: '0.30...|.=0|....', data: ['10','1']},
  {name: 'inmin',   wave: '0.30...|.=0|....', data: ['5','1']},
  {name: 'inhour',  wave: '0.30...|.=0|....', data: ['1','1']},
  {name: 'start',   wave: '0.10...|.10|....'},
  
  // 内部寄存器
  {name:"buzy_n_r", wave: "x.1.0...|...|...."},
  {name: "sec_r",   wave: "x..====|===|=0..", data: ['0','59','58',"",'0']},
  {name: "min_r",   wave: "x..==..|.==|=0..", data: ['0','59','58',"","0"]},
  {name: "hour_r",  wave: "x..==..|...|.0..", data: ['1',"0"]},
  
  // 输出信号
  {name: 'sec',     wave: 'x..====|===|=0..', data: ['0','59','58',"",'0']},
  {name: 'min',     wave: 'x..==..|.==|=0..', data: ['0','59','58',"","0"]},
  {name: 'hour',    wave: 'x..==..|...|.0..', data: ['1',"0"]},
  {name: 'alarm',   wave: '0......|...|.10.'},
  {name: 'buzy_n',  wave: 'x1.0...|...|..1.'}
]}
```

## 中断或重置模式

```ts
{signal: [
  // 输入信号
  {name: 'clk',     wave: 'p....|...|..'},
  {name: 'write',   wave: '10..........'},
  {name: 'up',      wave: '10..........'},
  {name: 'cut',     wave: '1......01...'},
  {name: 'insec',   wave: '3x..........', data: ['10']},
  {name: 'inmin',   wave: '3x..........', data: ['5']},
  {name: 'inhour',  wave: '3x..........', data: ['1']},
  {name: 'start',   wave: '10..........'},
  
  // 内部寄存器
  {name:"buzy_n_r", wave: "x1......0..."},
  {name: "sec_r",   wave: "x====|==0...", data: ['0','59','58',"",'0']},
  {name: "min_r",   wave: "x==....=0...", data: ['0','59','58',"","0"]},
  {name: "hour_r",  wave: "x==.....0...", data: ['1',"0"]},
  
  // 输出信号
  {name: 'sec',     wave: 'x====|==0...', data: ['0','59','58',"",'0']},
  {name: 'min',     wave: 'x==....=0...', data: ['0','59','58',"","0"]},
  {name: 'hour',    wave: 'x==.....0...', data: ['1',"0"]},
  {name: 'alarm',   wave: '0...........'},
  {name: 'buzy_n',  wave: 'x1......0...'}
]}
```
